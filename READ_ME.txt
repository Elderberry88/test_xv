
מיקום השינויים:
 Makefile       |  17 ++++++---
 defs.h         |   4 +++
 mutex.c        | 215 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 mutex.h        |  34 ++++++++++++++++++
 shop.c         | 416 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 shop_start.c   |  19 ++++++++++
 syscall.c      |  58 ++++++++++++++++++------------
 syscall.h      |  49 +++++++++++++++-----------
 sysfile.c      |  37 +++++++++++++++++---
 syssem.c       | 150 ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
 ulib.c         |  12 +++++--
 user.h         |  16 +++++++--
 usys.S         |   7 ++++

בנוסף שיניתי את הגדרת sem_open ממה שניתן כך ש-name הוא `const char *` ולא `char *` זה כמובן לא הגיוני אחרת.

אופן המימוש:
flock
המימוש מסתמך על זה שלכל file struct שמצביע לאותו inode תמיד מצביעים לאותו inode struct. כלומר ניתן להשתמש בכתובת של file->ip בתור הערוץ ל-sleep ו-wakeup.
כאשר מישהו מבקש לנעול את הקובץ נראה אם כבר יש מישהו שנועל את אותו inode ואם לא נוסיף את המצביע לfile struct לרשימת הקבצים הנעולים. ככה אנו יכולים לבדוק את הinode ואת הfile מעוגן יחיד.

semaphore
כאשר נוצרת סמפורה לראשונה היא נכנסת לרשימה ומצביע אליה מועבר לרשימת הosem של התהליך. נעשה refcount בדומה לקבצים כדי לוודא שסמפורות מתנקות כמו שצריך.
